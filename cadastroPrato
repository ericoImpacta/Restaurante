from flask import Flask, request, jsonify
from flask_cors import CORS
import mysql.connector

app = Flask(__name__)
CORS(app)

db = mysql.connector.connect(
    host="localhost",
    user="root",        
    password="Eagles6-",  
    database="restaurante_db"
)
cursor = db.cursor(dictionary=True)
  
  @app.route("/pratos", methods=["POST"])
def cadastrar_prato():
    data = request.json
    cursor.execute("INSERT INTO pratos (nome, preco, restaurante_id) VALUES (%s, %s, %s)",
                   (data["nome"], data["preco"], data["restaurante_id"]))
    db.commit()
    return jsonify({"message": "Prato cadastrado com sucesso!"})

@app.route("/pratos", methods=["GET"])
def listar_pratos():
    restaurante_id = request.args.get("restaurante_id")
    if restaurante_id:
        cursor.execute("SELECT * FROM pratos WHERE restaurante_id = %s", (restaurante_id,))
    else:
        cursor.execute("SELECT * FROM pratos")
    return jsonify(cursor.fetchall())
